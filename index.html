<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase CRUD Operations</title>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getDatabase, ref, set, get, update, remove } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-database.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAXZgxM6PU-T3D2811KnBszblRWju7rv1Y",
            authDomain: "dws-management.firebaseapp.com",
            databaseURL: "https://dws-management-default-rtdb.firebaseio.com",
            projectId: "dws-management",
            storageBucket: "dws-management.firebasestorage.app",
            messagingSenderId: "23827231923",
            appId: "1:23827231923:web:97141b6d19c7cd109d2cc6",
            measurementId: "G-L14GLJDYW7"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Create Data (Add new user)
        function createData() {
            const userName = document.getElementById('userName').value;
            const userEmail = document.getElementById('userEmail').value;

            if (userName && userEmail) {
                const newUserRef = ref(database, 'users/' + Date.now()); // Using timestamp as unique user ID
                set(newUserRef, {
                    name: userName,
                    email: userEmail
                }).then(() => {
                    alert('Data saved successfully!');
                    readData(); // Refresh user list after save
                }).catch((error) => {
                    console.error('Error saving data: ', error);
                });
            } else {
                alert('Please fill in both fields!');
            }
        }

        // Read Data (Fetch all users)
        function readData() {
            const usersListElement = document.getElementById('usersList');
            usersListElement.innerHTML = ''; // Clear the list before updating

            const usersRef = ref(database, 'users');
            get(usersRef).then((snapshot) => {
                const users = snapshot.val();
                if (users) {
                    for (let userId in users) {
                        const user = users[userId];
                        const li = document.createElement('li');
                        li.textContent = `${user.name} (${user.email}) - ID: ${userId}`;
                        usersListElement.appendChild(li);
                    }
                } else {
                    alert('No users found.');
                }
            }).catch((error) => {
                console.error('Error reading data: ', error);
            });
        }

        // Update Data (Modify user data)
        function updateData() {
            const userId = document.getElementById('userId').value;
            const userName = document.getElementById('userName').value;
            const userEmail = document.getElementById('userEmail').value;

            if (userId && userName && userEmail) {
                const userRef = ref(database, 'users/' + userId);
                update(userRef, {
                    name: userName,
                    email: userEmail
                }).then(() => {
                    alert('User data updated successfully!');
                    readData(); // Refresh user list after update
                }).catch((error) => {
                    console.error('Error updating data: ', error);
                });
            } else {
                alert('Please provide user ID, name, and email to update.');
            }
        }

        // Delete Data (Remove user by ID)
        function deleteData() {
            const userId = document.getElementById('userId').value;

            if (userId) {
                const userRef = ref(database, 'users/' + userId);
                remove(userRef).then(() => {
                    alert('User deleted successfully!');
                    readData(); // Refresh user list after delete
                }).catch((error) => {
                    console.error('Error deleting data: ', error);
                });
            } else {
                alert('Please provide a user ID to delete.');
            }
        }
    </script>
</head>
<body>

<h2>Firebase CRUD Operations</h2>

<!-- Input fields for data -->
<input type="text" id="userName" placeholder="Enter name" />
<input type="email" id="userEmail" placeholder="Enter email" />
<input type="text" id="userId" placeholder="Enter user ID for update/delete" />

<!-- Buttons for CRUD operations -->
<button onclick="createData()">Create Data</button>
<button onclick="readData()">Read Data</button>
<button onclick="updateData()">Update Data</button>
<button onclick="deleteData()">Delete Data</button>

<h3>Users List:</h3>
<ul id="usersList"></ul>

</body>
</html>